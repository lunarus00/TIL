## 106 DML - SELECT-2

#### 일반 형식

- ```sql
  SELECT [PREDICATE] [테이불명.]속성명 [AS 별칭][, [테이블명.]속성명, ...]
  [, 그룹함수(속성명) [AS 별칭]]
  [, WINDOW함수 OVER (PARTITION BY 속성명1, 속성명2, ...
                   ORDER BY 속성명3, 속성명4, ...) [AS 별칭]]
  FROM 테이블명[, 테이블명, ...]
  [WHERE 조건]
  [GROUP BY 속성명, 속성명, ...]
  [HAVING 조건]
  [ORDER BY 속성명 [ASC | DESC]];
  ```

- 그룹함수 : GROUP BY 절에 지정된 그룹별로 속성의 값을 집계할 함수를 기술한다

- WINDOW 함수 : GROUP BY 절을 이용하지 않고 속성의 값을 집계할 함수를 기술한다

  - PARTITION BY : WINDOW 함수가 적용될 범위로 사용할 속성을 지정한다
  - ORDER BY : PARTITION 안에서 정렬 기준으로 사용할 속성을 지정한다

- GROUP BY 절 : 특정 속성을 기준으로 그룹화하여 검색할 때 사용한다. 일반적으로 GROUP BY 절은 그룹 함수와 함께 사용된다

- HAVING절 : GROUP BY와 함께 사용되며, 그룹에 대한 조건을 지정한다



#### 그룹 함수 / WINDOW 함수

- 그룹 함수
  - GROUP BY 절에 지정된 그룹별로 속성의 값을 집계할 때 사용된다
  - COUNT(속성명) : 그룹별 튜플 수를 구하는 함수
  - SUM(속성명) : 그룹별 합계를 구하는 함수
  - AVG(속성명) : 그룹별 평균을 구하는 함수
  - MAX(속성명) : 그룹별 최대값을 구하는 함수
  - MIN(속성명) : 그룹별 최소값을 구하는 함수
  - STDDEV(속성명) : 그룹별 표준편차를 구하는 함수
  - VARIANCE(속성명) : 그룹별 분산을 구하는 함수
  - ROLLUP(속성명, 속성명, ...)
    - 인수로 주어진 속성을 대상으로 그룹별 소계를 구하는 함수
    - 속성의 개수가 n개이면 n+1 레벨까지, 하위 레벨에서 상위 레벨 순으로 데이터가 집계된다
  - CUBE(속성명, 속성명, ...)
    - ROLLUP과 유사한 형태이나 CUBE는 인수로 주어진 속성을 대상으로 모든 조합의 그룹별 소계를 구한다
    - 속성의 개수가 n개이면 2^n 레벨까지, 상위 레벨에서 하위 레벨 순으로 데이터가 집계된다
- WINDOW 함수
  - GROUP BY절을 이용하지 않고 함수의 인수로 지정한 속성을 범위로 하여 속성의 값을 집계한다
  - 함수의 인수로 지정한 속성이 대상 레코드의 범위가 되는데, 이를 윈도우(WINDOW)라고 부른다
  - WINDOW 함수
    - ROW_NUMBER() : 윈도우별로 각 레코드에 대한 일련 번호를 반환한다
    - RANK() : 윈도우별로 순위를 반환하며, 공동 순위를 반영한다
    - DENSE_RANK() : 윈도우별로 순위를 반환하며, 공동 순위를 무시하고 순위를 부여한다



#### WINDOW 함수 이용 검색

- GROUP BY 절을 이용하지 않고 함수의 인수로 지정한 속성을 범위로 하여 속성의 값을 집계한다



#### 그룹 지정 검색

- GROUP BY절에 지정한 속성을 기준으로 자료를 그룹화하여 검색한다



#### 집합 연산자를 이용한 통합 질의

- 집합 연산자를 사용하여 2개 이상의 테이블의 데이터를 하나로 통합한다

- 표기 형식

  - ```SQL
    SELECT 속성명1, 속성명2, ...
    FROM 테이블명
    UNION | UNION ALL | INTERSECT | EXCEPT
    SELECT 속성명1, 속성명2, ...
    FROM 테이블명
    [ORDER BY 속성명 [ASC | DESC]];
    ```

  - 두 개의 SELECT문에 기술한 속성들은 개수와 데이터 유형이 서로 동일해야 한다

  - 집합 연산자의 종류(통합 질의의 종류)

    - UNION
      - 두 SELECT문의 조회 결과를 통합하여 모두 출력한다
      - 중복된 행은 한 번만 출력한다
      - 합집합
    - UNION ALL
      - 두 SELECT문의 조회 결과를 통합하여 모두 출력한다
      - 중복된 행도 그대로 출력한다
      - 합집합
    - INTERSECT
      - 두 SELECT문의 조회 결과 중 공통된 행만 출력한다
      - 교집합
    - EXCEPT
      - 첫 번째 SELECT문의 조회 결과에서 두 번째 SELECT문의 조회 결과를 제외한 행을 출력한다